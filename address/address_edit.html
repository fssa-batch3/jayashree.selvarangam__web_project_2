<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>coffee shop </title>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous" referrerpolicy="no-referrer">
        <link rel="stylesheet" href="../../assets/css/profile.css">
        <link rel="stylesheet" href="../../assets/css/header.css">
        <link rel="stylesheet" href="../../assets/css/footer.css ">
        <link href="https://fonts.googleapis.com/css2?family=Aclonica&family=Merienda:wght@300;400;500;600&family=Montserrat:wght@400;500&family=Poppins:ital,wght@0,100;0,300;0,400;1,100;1,200;1,300;1,400&family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <style>
          * { font-family: 'Aclonica', sans-serif;
              font-family: 'Merienda', cursive;
              font-family: 'Montserrat', sans-serif;
              font-family: 'Poppins', sans-serif;
              font-family: 'Quicksand', sans-serif;
        }
        </style>
    </head>
    <body>
    
        <section class="profile" id="profile">

            <h1 class="heading">
              edit  address 
            </h1>
         
            <form action="" name="add-product-form" >
                <!-- <i class="fa-solid fa-trash" id="delete"></i> -->
                <label>Address type:</label>
                <input type="text" id="address-type" class="box" >
                <!-- <label>House no:</label>
                <input type="number" id="house-no" class="box" >
                <label>Area:</label>
                <input type="text" id="area"class="box" >
                <label> pincode:</label>
                <input type="number" id="pincode"  maxlength="5" pattern="\d{5}" title="must have 6 digits" class="box" > -->
                <!-- <label for="default-address">default address</label>
                <input type="checkbox" id="default-address"> -->
                <!-- <a href="../../pages/profile/profile_edit.html"><input type="submit" value="Edit" class="btn"></a>
                    <span class="save"> -->
                
                <!--<button  class="btn" id="delete" >delete profile
                    </button>-->
                    <button type="submit" class="btn" id="save">Save
                    </button>
            </form>
         
        </section>

    </body>
    <script>




let stored_address = JSON.parse(localStorage.getItem('address'));

const queryString = window.location.search;
// console.log(queryString);
const urlParams = new URLSearchParams(queryString);
console.log(urlParams);
const address = urlParams.get("address_id");
// console.log(product);

function findAddress(e) {
  return e.id === address;
}

let addressData = stored_address.find(findAddress);
console.log(addressData)

document.getElementById("address-type").value = addressData.address1;
// document.getElementById("house-no").value = addressData.house_no;
// document.getElementById("area").value = addressData.area;
// document.getElementById("pincode").value = addressData.pincode;

const addProductForm = document.forms["add-product-form"];
// Add an event listener to the form submit event
addProductForm.addEventListener("submit", function(event) {

event.preventDefault();

const stored_address = JSON.parse(localStorage.getItem("address"));
const queryString = window.location.search;
// console.log(queryString);
const urlParams = new URLSearchParams(queryString);
console.log(urlParams);
const address = urlParams.get("address_id");
// console.log(product);
function findAddress(e) {
  return e.id === address;
}
let addressData = stored_address.find(findAddress);   
// getting the updated data from the input field;


const up_address_typeInput = addProductForm['address-type'];
  // const up_house_noInput = addProductForm["house-no"];
  // const up_areaInput = addProductForm["area"];
  // const up_pincodeInput = addProductForm["pincode"];

  const up_address_type = up_address_typeInput.value.trim();
  // const up_house_no = up_house_noInput.value.trim();
  // const up_area = up_areaInput.value.trim();
  // const up_pincode = up_pincodeInput.value.trim();

  if (up_address_type === "") {
  showError(up_address_typeInput, "Address is required");
  return;
  }

//   if (up_house_no === "") {
//   showError(up_house_noInput, "House no is required");
//   return;
// }

//   if (up_area === "") {
//   showError(up_areaInput, "Area is required");
//   return;
//   }
  
//   if ( up_pincode=== "") {
//   showError(up_pincodeInput, "pincode is required");
//   return;
//   }
 
// // const up_checkbox = checkbox.checked;
  // paste the updated data to the correct object
  addressData.address1 = up_address_type;
  // addressData.house_no =up_house_no ;
  // addressData.area = up_area;
  // addressData.pincode =up_pincode ;
//   addressData.value=value1;

  // again paste it to the
  localStorage.setItem("address", JSON.stringify(stored_address));
  console.log(addressData,stored_address)
  
  addProductForm.submit();
  location.href="../../address/address.html";

});

// Helper function to show an error message for a form input
function showError(input, errorMessage) {
  // Set the input as invalid
  input.setCustomValidity(errorMessage);

  // Display the error message
  const errorElement = document.createElement("div");
  errorElement.className = "error-message";
  errorElement.textContent = errorMessage;
  input.parentNode.insertBefore(errorElement, input.nextSibling);

  // Add a listener to remove the error message when the input is changed
  input.addEventListener("input", function() {
    input.setCustomValidity("");
    errorElement.remove();
  });
}


    </script>
    <script src="../../pages/order/header.js"></script>
    </html>
