<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>coffee shop </title>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous" referrerpolicy="no-referrer">
        <link rel="stylesheet" href="../../assets/css/profile.css">
        <link rel="stylesheet" href="../../assets/css/header.css">
        <link rel="stylesheet" href="../../assets/css/footer.css ">

    </head>
    <body>
    
        <section class="profile" id="profile">

            <h1 class="heading">
              edit  address 
            </h1>
         
            <form action="" >
                <!-- <i class="fa-solid fa-trash" id="delete"></i> -->
                <label>Address type:</label>
                <input type="text" id="address-type" class="box" required>
                <label>House no:</label>
                <input type="number" id="house-no" class="box" required>
                <label>Area:</label>
                <input type="text" id="area"class="box" required>
                <label> pincode:</label>
                <input type="number" id="pincode" class="box" required>
                <label for="default-address">default address</label>
                <input type="checkbox" id="default-address">
                <!-- <a href="../../pages/profile/profile_edit.html"><input type="submit" value="Edit" class="btn"></a>
                    <span class="save"> -->
                
                <!-- <button  class="btn" id="delete" >delete profile
                    </button>  -->
               


        
            </form>
            <button type="button" class="btn" id="save">Save
            </button>
        </section>

    </body>
    <script>
const stored_address = JSON.parse(localStorage.getItem("address"));

const queryString = window.location.search;
// console.log(queryString);
const urlParams = new URLSearchParams(queryString);
console.log(urlParams);
const address = urlParams.get("address_id");
// console.log(product);

function findAddress(e) {
  return e.id === address;
}

let addressData = stored_address.find(findAddress);
console.log()

document.getElementById("address-type").value = addressData.address_type;
document.getElementById("house-no").value = addressData.house_no;
document.getElementById("area").value = addressData.area;
document.getElementById("pincode").value = addressData.pincode;

// const checkbox = document.getElementById("default-address");
//             const isChecked = checkbox.checked;
//             console.log(isChecked)
//             let value;
//             if(isChecked===true){
//                 value=true
//                 console.log(1)
//                 let stored_address = JSON.parse(localStorage.getItem('address'));
//              for(let i=0;i<stored_address.length;i++){
//                 stored_address.value=false
//                 localStorage.setItem('address',JSON.stringify(stored_address))
//              }
//             }else{
//                 value=false
//             }




let save = document.getElementById('save')
save.addEventListener('click',function update(e) {


  const checkbox = document.getElementById("default-address");
            const isChecked = checkbox.checked;
            let value1;
            if(isChecked===true){
                value1=true
                let stored_address = JSON.parse(localStorage.getItem('address'));
             for(let i=0;i<stored_address.length;i++){
                if(stored_address[i]['value']===true){
                    stored_address[i]['value'] = false;
                }
                localStorage.setItem('address',JSON.stringify(stored_address))
                console.log(stored_address)
             } 
            }else{
                value1=false
            }

const stored_address = JSON.parse(localStorage.getItem("address"));
const queryString = window.location.search;
// console.log(queryString);
const urlParams = new URLSearchParams(queryString);
console.log(urlParams);
const address = urlParams.get("address_id");
// console.log(product);
function findAddress(e) {
  return e.id === address;
}
let addressData = stored_address.find(findAddress);   
// getting the updated data from the input field
const up_address_type = document.getElementById("address-type").value;
const up_house_no = document.getElementById("house-no").value;
const up_area = document.getElementById("area").value;
const up_pincode = document.getElementById("pincode").value;
const up_checkbox = checkbox.checked;
  // paste the updated data to the correct object
  addressData.address_type = up_address_type;
  addressData.house_no =up_house_no ;
  addressData.area = up_area;
  addressData.pincode =up_pincode ;
  addressData.value=value1;

  // again paste it to the
  localStorage.setItem("address", JSON.stringify(stored_address));
  console.log(addressData,stored_address)
  
  
})
    </script>
    <script src="../../pages/order/header.js"></script>
    </html>
